# User Action Requirement: Referrals

---

## 1. Overview

- **User Action:**  
  `Referrals`

- **Short Description:**  
  Allows users to view their referral statistics, track earnings from referred users, access their unique referral link, and claim rewards when eligible.

- **Scope:**  
  Multi-chain referral tracking system that enables users to monitor performance metrics, understand the tiered commission structure, and participate in the bot's affiliate program.

---

## 2. Detailed Functionality

### 2.1 Functional Requirements
- **Input / Parameters:**
    - **Trigger:** User clicks "Referrals" button from main menu or uses `/referrals` command
    - **No additional parameters required**

- **Expected Outcome / Response:**  
  User receives a comprehensive overview of their referral program performance, including number of referrals, total volume, earnings by timeframe, unclaimed balance, and their personal referral link that they can share with others.

- **User Interface Behavior:**  
  **Referral Information Display:**
  ```
  🔗 Referral Stats
  👥 Total Referrals: [Number]
  📊 Total Referred Volume: [Amount]
  💰 Total Earned: [Amount] [Native Token]
  💸 Unclaimed Balance: [Amount] [Native Token]
  
  Earnings Breakdown:
  ✅ Month 1: [Volume] [Native Token] × 70% = [Earnings] [Native Token]
  ✅ Month 2: [Volume] [Native Token] × 50% = [Earnings] [Native Token]
  ✅ Month 3: [Volume] [Native Token] × 30% = [Earnings] [Native Token]
  ✅ Month 4+: [Volume] [Native Token] × 30% = [Earnings] [Native Token]
  
  🔗 Your Referral Link:
  [Personalized Referral Link]
  
  ⚠️ You can claim rewards once you reach 1 [Native Token].
  ```

  **Buttons:**
  ```
  Row 1:
  "📋 Copy Link" | "📱 Share Link"
  
  Row 2:
  "💰 Claim Rewards" (activated when balance reaches threshold)
  
  Row 3:
  "Back to Menu"
  ```

### 2.2 Process Flow
- **Step 1:** User clicks the "Referrals" button from the main menu or uses the `/referrals` command.

- **Step 2:** Bot retrieves the user's referral data, including:
    - Total number of users who signed up using their referral link
    - Total trading volume generated by referred users
    - Commissions earned, broken down by time periods and corresponding rates
    - Current unclaimed balance
    - User's unique referral link

- **Step 3:** Bot displays the comprehensive referral statistics message with the tiered commission structure:
    - Month 1: 70% commission rate on referred trading
    - Month 2: 50% commission rate on referred trading
    - Month 3: 30% commission rate on referred trading
    - Month 4+: 30% commission rate on referred trading

- **Step 4:** Bot displays action buttons allowing the user to:
    - Copy their referral link to clipboard
    - Share their referral link directly to other platforms
    - Claim rewards (if eligible)
    - Return to the main menu

- **Step 5:** If user clicks "Copy Link", the bot copies the referral link to the user's clipboard.

- **Step 6:** If user clicks "Share Link", the bot provides sharing options through Telegram's native sharing interface.

- **Step 7:** If user clicks "Claim Rewards" and has reached the minimum threshold (1 native token):
    - Bot initiates the withdrawal process for the unclaimed balance
    - User receives confirmation when funds are transferred
    - Unclaimed balance is reset to zero

- **Step 8:** If user clicks "Claim Rewards" but has not reached the minimum threshold:
    - Bot reminds the user of the minimum claiming requirement
    - No withdrawal is processed

---

## 3. Affected Systems and Dependencies

- **Chain Specific Requirements:**  
  `[Indicate if this action is chain-specific. For example, “This action applies only to the Binance Smart Chain and Ethereum networks” or “This action displays portfolio data across all chains, with sorting options by chain.”]`

- **Integration Points:**
    - **Telegram API:** `[Details regarding message formatting, command parsing, etc.]`
    - **External Trading APIs / Exchanges:** `[Details on order submission, tracking, and status updates.]`
    - **Blockchain Network APIs:** `[Details on blockchain-specific requirements such as fee calculations, chain validations, etc.]`
    - **Signal Providers (if applicable):** `[Describe how signals affect this action.]`

- **Portfolio / Order Management:**  
  `[Specify how this action interacts with the portfolio system (e.g., updating portfolio balances, order histories, etc.).]`

- **Other Systems:**  
  `[List any other affected or integrated systems.]`

---

## 4. Error Handling and Edge Cases

- **Common Error Scenarios:**
    - `[Describe a scenario, e.g., “Invalid order parameters” and how the bot should respond.]`
    - `[Example: “User tries to cancel an order that does not exist.”]`

- **Validation & Fallback Mechanisms:**  
  `[Detail any input validations, fallback procedures, or safety checks that should be in place.]`

---

## 5. Non-Functional Requirements

- **Performance:**  
  `[Specify performance metrics such as maximum response time or acceptable latency.]`

- **Security:**  
  `[Outline security measures including data encryption, authentication, and secure session management.]`

- **Scalability:**  
  `[Discuss how the system should handle growth in user base and transaction volume.]`

- **Usability:**  
  `[Provide guidelines on the user experience, including clarity of commands and response messages.]`

---

## 6. Future Enhancements

- `[List any potential improvements or additional features that could be implemented in future releases.]`

---

**Notes:**
- Replace all placeholders (e.g., `[Action Name]`) with the specific details for the user action.
- Use this template to create individual requirement specification pages for each user action (e.g., `/start`, `/place_limit_order`, `/cancel_order`, `/order_status`, etc.).
- Ensure that each requirement clearly defines how the action functions and its impact on related systems.